MMD-Facial-Morphing-Shader
==========================

MikuMikuDance for Unityの表情用シェーダーをちょっと組めないかな議事録．

==========================

# 検討

表情用シェーダーをどうしたものかアイディアを出してみる．

## シンプルに，表情ごとにテクスチャを使う

テクスチャの座標がそのまま頂点インデックスに対応している．
頂点ごとにモーフィングする量を書くことで，頂点座標 + (表情 x モーフ量)の形で表現する．

### 利点

非常に作りやすい．すぐに書けると思う．

### 問題点

モーフしない頂点のほうが多いので，無駄な情報が書き込まれてしまう．

# 実装

あまり賢くない実装をする．

## 設計

設計は2種類に分ける．
シェーダのテンプレートとなる部分と，シェーダそのものを自動生成する部分．

###　シェーダーテンプレート

シェーダー用のテンプレートのメモ．

#### 定義

モーフする正規化されたベクトルを記したテクスチャをMorphingMapと呼ぶ．
そのベクトルを浮動小数点倍するためのテクスチャをMagnitudeMapと呼ぶ．
モーフの変化量を表す浮動小数点をWeightと呼ぶ．

#### 概要

MorphingMapはARGBで表される．RGBの順番でそれぞれxyzが入る．

MagnitudeMapはRGBAで表される．
それぞれfloat型を4分割にしたもので，R[0]，G[1]，B[2]，A[3]となっている．

Weightはfloat型で表される．
0.0から1.0までの値を取り，表情の変化量として表される．
従って，SkinnedVector = Morphing x　Magnitude x Weightで表情が表される．
